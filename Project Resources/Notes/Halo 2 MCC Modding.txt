
////////////////////////
// Halo 2 MCC Modding //
////////////////////////



/*--- Overview ---*/

Mod Tools
  - Assembly: Used before official mod tools were released. Reads map files as tags and lets you
              edit those tag values directly. Can be used to compress/decompress maps.
  - Guerilla: An official, comprehensive tag editor.
  - Tool: A terribly named command line utility that does all kinds of stuff. Most important for
          us, it allows you to compile a bunch of tags into a .map file that can be played in MCC. 



/*--- Rebuilding Map from Tags in Guerilla ---*/

NOTE: Doesn't support compile flags, which is a problem for remastered campaign levels. In general
      probably just safest to do this via command line (see below).

0. Navigate to H2EK Folder via command line.

1. Open Guerrila

	guerilla.exe -tags_dir "D:\Games\Installed - Steam\steamapps\common\H2EK\tags"

2. In Guerrila -> File -> Run Tool -> Select "build cache file" & browse to scenario file.

3. Click "Ok". Map file will be saved to h2_maps_win64_dx11 directory.



/*--- Rebuilding Map from Tags via Command Line ---*/

NOTE: Supports compile flags! :)

1. Navigate to H2EK Folder via command line.

2. Run the Following

	tool build-cache-file scenarios\solo\01b_spacestation\01b_spacestation dx11_64 remastered_support



/*--- More Reference ---*/

Tool Documentation: https://c20.reclaimers.net/h2/tools/h2-ek/h2-tool/

guerilla -tags_dir "D:\Games\Installed - Steam\steamapps\common\H2EK\tags"

00a_introduction
01a_tutorial
01b_spacestation
03a_oldmombasa
03b_newmombasa
04a_gasgiant
04b_floodlab
05a_deltaapproach
05b_deltatowers
06a_sentinelwalls
06b_floodzone
07a_highcharity
07b_forerunnership
08a_deltacliffs
08b_deltacontrol



///////////////////////////
// H2A Audio Restoration //
///////////////////////////

1. Start by replacing the all tags in the "sound_remaster" folder with their corresponding tags in
   the "sound" folder. This works for ~80% of in-game audio. The many exceptions are chronicled below.

2. Special Cases (Scripted)

    All Tags
     ".sound_looping" Files - These need to be preserved as-is.
     "*_lod.sound" Files - These are remaster additions that don't exist in the classic game.
                           They're distant, more echoed versions of game sounds to be
                           generated by NPC fire. Can be deleted. In some cases, the min/max distance
                           of the object's base sound tag must be updated via Guerilla. Otherwise,
                           sound can't be heard at a distance. (Automate?)
     "*_swtnr.sound" Files - These are remaster additions that don't exist in the classic game.
                             They're followup sounds to be played after the classic sound. Safe
                             to delete; they just won't play.
     "*_lfe.sound" Files - Also remaster additions that don't exist in the classic game. These sounds
                           seem to be an additional bass layer that plays alongside standard sounds
                           to give them more punch. Can be safely deleted.

    Weapons
      Plasma Rifle - deleted "plas_rifle_fire_bottom.sound", seems to be new sound specifically
                     emitted from bottom of gun when firing.
      Energy Sword - sword_ready.sound (classic) --> energy_sword_ready.sound (remaster)
      Sniper Rifle - Zoom in/out wrong?
      Beam Rifle - beam_rifle_zoom_in[/out].sound (classic) -> beamrifle_zoom/in[/out].sound (remaster)
      Rocket - rocket_expl.sound (classic) -> projectile_exp/close.sound (remaster)
               Zoom in/out wrong (same as sniper?)
      Chain Gun - Remastered warthog turret has annoying whirring noise. Can remove by deleting
                  "weapons/chain_gun/chaingun_spin.sound" in "sound_remaster".
      Fuel Rod Gun - Explosion sounds too punchy? Tag files look good. Blegh, gonna just leave it.
      Sentinel Beam - Weapon audio stored in character folder. Needs to be updated there.
                      "sent_gun\" (classic) -> "sent_gun\" (remaster), "sent_gun_lod" (remaster)

    Vehicles
      Warthog
        renamed tag for crash sfx
      Scorpion
        deleted new tags for turret spin
        deleted new tag for reload
        preserved new tag for Delta Halo dropoff
      Ghost
        renamed tag for main fire
        deleted tag for extra boost
      Wraith
        renamed tag for main fire
        renamed tag for mortar explosion



    Characters
      Sentinel Enforcer
        needler_fire_sentinel_enforcer.sound (classic) -> sentinel_enforcer_laser.sound (remaster)
        Note: The remastered primary fire actually sounds pretty good as a Enforcer rocket fire
              and helps broadcast the incoming salvo... Might make it optional later.


3. Manual Fixes (Manual)

    Weapons
      Sentinel Beam
        sound_remastered\characters\sentinel\sentinel_gun\sent_gun\* - max dist 120
      Plasma Pistol 
        sound_remastered\weapons\plasma_pistol\fire.sound - max dist 120
      Beam Rifle
        sound_remastered\weapons\beam_rifle\beam_rifle_fire.sound - max dist 300
      Covenant Carbine
        sound_remastered\weapons\covenant_carbine\fire.sound - max dist 120 (Doesn't work?)
      Needler
        sound_remastered\weapons\needler\fire.sound - max dist 120
      Plasma Rifle

    Vehicles

    Characters
      Sentinel Enforcer
        characters\sentinel\sentinel_enforcer_laser.sound - "play only in legacy mode" = unticked
        characters\sentinel\sentinel_enforcer_laser.sound - min dist = 5, max dist = 75



/*--- Changing Tags in Assembly ---*/

1. Open Assembly (Halo mod tool, not machine language)

2. Tools > Map Compressor > Set "Input Map" to selected MCC map > Click "De/Compress Map"

3. Open Map in New Tab > Tags tab

4. Find & Edit the appropriate tag. Then compress map again and play the game.